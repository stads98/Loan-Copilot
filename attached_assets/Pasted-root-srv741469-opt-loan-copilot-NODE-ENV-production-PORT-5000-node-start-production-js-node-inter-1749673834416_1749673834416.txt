root@srv741469:/opt/loan-copilot# NODE_ENV=production PORT=5000 node start-production.js
node:internal/modules/cjs/loader:1137
  throw err;
  ^

Error: Cannot find module '/opt/loan-copilot/start-production.js'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1134:15)
    at Module._load (node:internal/modules/cjs/loader:975:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v18.19.1
root@srv741469:/opt/loan-copilot# cat > start-production.js << 'EOF'
> import express from 'express';
> import { registerRoutes } from './server/routes.js';
> import path from 'path';
> import { fileURLToPath } from 'url';
> const __filename = fileURLToPath(import.meta.url);
> const __dirname = path.dirname(__filename);
> const app = express();
> const port = process.env.PORT || 5000;
> // Serve static files from dist/public
> app.use(express.static(path.join(__dirname, 'dist/public')));
> // Register API routes
> await registerRoutes(app);
> // Catch all handler for client-side routing
> app.get('*', (req, res) => {
>   res.sendFile(path.join(__dirname, 'dist/public/index.html'));
});
app.listen> });
> app.listen(port, '0.0.0.0', () => {
>   console.log(`Server running on port ${port}`);
> });
> EOF
root@srv741469:/opt/loan-copilot# NODE_ENV=production PORT=5000 node start-production.js
node:internal/errors:496
    ErrorCaptureStackTrace(err);
    ^

Error [ERR_MODULE_NOT_FOUND]: Cannot find module '/opt/loan-copilot/server/routes.js' imported from /opt/loan-copilot/start-production.js
    at new NodeError (node:internal/errors:405:5)
    at finalizeResolution (node:internal/modules/esm/resolve:327:11)
    at moduleResolve (node:internal/modules/esm/resolve:980:10)
    at defaultResolve (node:internal/modules/esm/resolve:1193:11)
    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:403:12)
    at ModuleLoader.resolve (node:internal/modules/esm/loader:372:25)
    at ModuleLoader.getModuleJob (node:internal/modules/esm/loader:249:38)
    at ModuleWrap.<anonymous> (node:internal/modules/esm/module_job:76:39)
    at link (node:internal/modules/esm/module_job:75:36) {
  url: 'file:///opt/loan-copilot/server/routes.js',
  code: 'ERR_MODULE_NOT_FOUND'
}

Node.js v18.19.1
root@srv741469:/opt/loan-copilot# cat > Dockerfile << 'EOF'
> FROM node:18-alpine
> WORKDIR /app
> COPY package*.json ./
> RUN npm install
> COPY . .
> RUN chmod -R 755 node_modules/.bin/ || true
> RUN npm run build
> RUN mkdir -p uploads
> EXPOSE 5000
> ENV NODE_ENV=production
> ENV PORT=5000
> CMD ["node", "start-production.js"]
> EOF
root@srv741469:/opt/loan-copilot# sed -i 's/"build": "vite build && esbuild.*"/"build": "vite build"/' package.json
root@srv741469:/opt/loan-copilot#